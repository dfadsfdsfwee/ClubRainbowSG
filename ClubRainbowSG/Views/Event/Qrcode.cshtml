<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Scanner</title>
    <script src="https://cdn.jsdelivr.net/npm/html5-qrcode@2.0.0/minified/html5-qrcode.min.js"></script>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }

 
 h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .main_division {
            margin-left: auto;
            margin-right: auto;
            margin-bottom: 10%;
            margin: 0;
            padding-left: 10%;
            padding-right: 10%;
            background-color: #f1f1f1;
        }

        .sub_division {
            text-align: center;
            margin-bottom: 2%;
            margin-top: 4%;
            padding: 5%;
            border: none;
            border-radius: 10px;
            background-color: white;
        }

        .error-message {
            color: #BA2D32;
            font-size: 14px;
            margin-top: 5px;
            margin-bottom: 5px;
        }

        #qr-code-scanner {
            width: 100%;
            height: 400px;
            border: 1px solid black;
            margin-top: 10px;
        }

        #file-input {
            margin-top: 10px;
        }

        #status {
            margin-top: 10px;
            color: green;
            font-weight: bold;
        }

        #access-button {
            margin-top: 10px;
            display: none;
        }

        .btn {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            background-color: #f1a259;
            color: #fff;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            display: block;
            transition: background-color 0.3s ease;
        }

        .btn:hover {
            background-color: #FF7F50;
            color: #fff;
        }

        .btn-green {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            background-color: #439551;
            color: #fff;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: block;
            box-sizing: border-box;
        }

        .btn-green:hover {
            background-color: #589892;
            color: #fff;
        }

      
       
    </style>
</head>
<body>

    <div class="main_division">
        <div class="sub_division">
            <h1>QR Code Scanner</h1>
            <button id="start-scanning-button" class="btn">Start Scanning</button>
            <button id="stop-scanning-button" class="btn" disabled>Stop Scanning</button>
            <input type="file" id="file-input" accept="image/*">
            <div id="qr-code-scanner"></div>

            <div id="result">
                <p>QR Code result: <span id="qr-result"></span></p>
            </div>

            <!-- Button to access the website -->
            <button id="access-button" class="btn-green">Go to Website</button>

            <p id="status"></p>
        </div>
    </div>

    <script>
        let scanner;

        const startScanningButton = document.getElementById("start-scanning-button");
        const stopScanningButton = document.getElementById("stop-scanning-button");
        const fileInput = document.getElementById("file-input");
        const qrScannerContainer = document.getElementById("qr-code-scanner");
        const qrResult = document.getElementById("qr-result");
        const status = document.getElementById("status");
        const accessButton = document.getElementById("access-button");

        function updateStatus(message, color = "green") {
            status.textContent = message;
            status.style.color = color;
        }

        startScanningButton.addEventListener("click", function () {
            updateStatus("Starting scanner...");
            if (scanner) {
                scanner.stop().then(() => {
                    scanner = null;
                    initializeScanner();
                }).catch(err => {
                    updateStatus("Error stopping scanner: " + err, "red");
                });
            } else {
                initializeScanner();
            }
        });

        function initializeScanner() {
            scanner = new Html5Qrcode("qr-code-scanner");
            scanner.start(
                { facingMode: "environment" },
                {
                    fps: 10,
                    qrbox: 250,
                },
                (decodedText) => {
                    updateStatus("QR Code decoded: " + decodedText);
                    qrResult.textContent = decodedText;
                    stopScanning();
                },
                (errorMessage) => {
                    console.log("Scanning error: " + errorMessage);
                }
            ).then(() => {
                stopScanningButton.disabled = false;
                updateStatus("Scanner is running...");
            }).catch(err => {
                updateStatus("Error starting scanner: " + err, "red");
            });
        }

        stopScanningButton.addEventListener("click", function () {
            stopScanning();
        });

        function stopScanning() {
            if (scanner) {
                scanner.stop().then(() => {
                    stopScanningButton.disabled = true;
                    updateStatus("Scanner stopped.");
                    clearScannerView();
                }).catch(err => {
                    updateStatus("Error stopping scanner: " + err, "red");
                });
            }
        }

        function clearScannerView() {
            qrScannerContainer.innerHTML = "";
        }

        fileInput.addEventListener("change", function (event) {
            const file = event.target.files[0];
            if (!file) {
                updateStatus("No file selected", "red");
                return;
            }

            if (!scanner) {
                scanner = new Html5Qrcode("qr-code-scanner");
            }

            scanner.scanFile(file, true)
                .then(decodedText => {
                    qrResult.textContent = decodedText;
                    updateStatus("Decoded from file: " + decodedText);

                    // Show the access button and set its link
                    accessButton.style.display = "block";
                    accessButton.onclick = function () {
                        window.location.href = decodedText; // Redirect to the decoded URL
                    };
                })
                .catch(err => {
                    updateStatus("Error scanning file: " + err, "red");
                });
        });
    </script>

</body>
</html>
